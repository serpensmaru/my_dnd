(()=>{"use strict";class e{constructor(e){this.container=document.querySelector(".container"),this.column=e,this.id=null,this.card=null,this.text=null,this.btn=null,this.idReserv=[]}cardMaP(e){return this.id=e,`<div class="card_content data-id_${e}">\n                <textarea class="card_input" type="text" placeholder="Enter a title for this card"></textarea>\n                <button class="card_delete hidden">&#10006;</button>\n            </div>`}createCard(e){const t=this.container.querySelector(`.cards_${e}`);this.id=this.generateId(),t.insertAdjacentHTML("beforeend",this.cardMaP(this.id)),this.card=t.querySelector(`.data-id_${this.id}`),this.text=this.card.querySelector(".card_input").value,this.btn=this.card.querySelector(".card_delete")}saveCard(){this.text=this.card.querySelector(".card_input").value,""===this.text&&this.delete(this.card),this.card.querySelector(".card_input").blur()}delete(){this.card.remove()}generateId(){const e=Math.floor(1e6*Math.random());return this.idReserv.includes(e)?this.generateId():(this.idReserv.push(e),e)}}(new class{constructor(){this.container=null,this.actualElement=null,this.onMouseOver=this.onMouseOver.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.eventCardMove=this.eventCardMove.bind(this),this.actualElementClone=null}bindToDOM(e){this.container=e,this.eventListenerAdd("todo"),this.eventListenerAdd("progress"),this.eventListenerAdd("done"),document.documentElement.addEventListener("mouseup",this.onMouseUp)}eventListenerAdd(e){this.container.querySelector(`.an_card_add_${e}`).addEventListener("mousedown",(t=>{t.preventDefault(),this.addCard(e)}))}addCard(t){this.container.querySelector(`.an_card_add_${t}`).classList.add("hidden");this.container.querySelector(`.card_add_${t}`).classList.remove("hidden");const n=new e(t);n.createCard(t),this.eventListenerAddButton(t,n)}eventListenerAddButton(e,t){this.container.querySelector(`.card_add_${e}`).addEventListener("mousedown",(n=>{n.preventDefault(),this.addCardButon(e,t)}))}addCardButon(e,t){this.container.querySelector(`.an_card_add_${e}`).classList.remove("hidden");this.container.querySelector(`.card_add_${e}`).classList.add("hidden"),t.saveCard();const{card:n}=t;n.addEventListener("mouseover",(e=>{e.preventDefault(),this.showClose(n,t)})),n.addEventListener("mouseout",(e=>{e.preventDefault(),this.hiddenClose(n)})),n.addEventListener("mousedown",(e=>{e.preventDefault(),this.actualElement=document.querySelector(`.data-id_${t.id}`),this.eventCardMove(e)}))}showClose(e,t){const n=e.querySelector(".card_delete");n.classList.remove("hidden"),n.addEventListener("mousedown",(s=>{s.preventDefault(),this.closeClick(e,n,t)}))}closeClick(e,t,n){e.remove(),e.removeEventListener("mouseover",(t=>{t.preventDefault(),this.showClose(e)})),e.removeEventListener("mouseout",(t=>{t.preventDefault(),this.hiddenClose(e)})),e.removeEventListener("mousedown",(e=>{e.preventDefault(),this.actualElement=document.querySelector(`.data-id_${n.id}`),this.eventCardMove(e)})),t.removeEventListener("mousedown",(n=>{n.preventDefault(),this.closeClick(e,t)}))}hiddenClose(e){const t=e.querySelector(".card_delete");t.classList.add("hidden"),t.removeEventListener("mousedown",(n=>{n.preventDefault(),this.closeClick(e,t)}))}eventCardMove(e){const t=this.actualElement.getBoundingClientRect();this.cursorX=e.clientX-t.left,this.cursorY=e.clientY-t.top,this.actualElement.classList.add("dragged"),document.body.style.cursor="grabbing",document.documentElement.addEventListener("mouseover",this.onMouseOver)}onMouseOver(e){this.actualElement.style.left=e.pageX-this.cursorX+"px",this.actualElement.style.top=e.pageY-this.cursorY+"px",this.actualElementClone=this.actualElement.cloneNode(!0),this.actualElementClone.querySelector(".card_input").className="card_clone_input",this.actualElementClone.className="card_clone";const{target:t}=e,n=t.closest(".column-item");t.closest(".card_content")?(null!==document.querySelector(".card_clone")&&document.querySelector(".card_clone").remove(),t.closest(".cards").insertBefore(this.actualElementClone,t.closest(".card_content"))):null!==n?(null!==document.querySelector(".card_clone")&&document.querySelector(".card_clone").remove(),n.querySelector(".cards").appendChild(this.actualElementClone)):t.closest(".card_content")||t.closest(".column-item")||null===document.querySelector(".card_clone")||document.querySelector(".card_clone").remove(),null!==this.actualElementClone&&this.actualElementClone.addEventListener("mouseup",this.onMouseUp)}onMouseUp(e){const{target:t}=e;if(null!==document.querySelector(".dragged")){const n=t.closest(".column-item"),s=t.closest(".card_clone");if(null!==n)return n.querySelector(".cards").insertBefore(this.actualElement,this.actualElementClone),document.querySelector(".card_clone").remove(),this.actualElement.classList.remove("dragged"),this.actualElement=void 0,document.body.style.cursor="auto",this.actualElementClone.removeEventListener("mouseup",this.onMouseUp),void document.documentElement.removeEventListener("mouseover",this.onMouseOver);if(null!==s){const t=document.elementFromPoint(e.clientX,e.clientY);return t.closest(".card_content")?t.closest(".cards").insertBefore(this.actualElement,t.closest(".card_content")):t.closest(".cards").appendChild(this.actualElement),document.querySelector(".card_clone").remove(),this.actualElement.classList.remove("dragged"),this.actualElement=void 0,document.body.style.cursor="auto",this.actualElementClone.removeEventListener("mouseup",this.onMouseUp),void document.documentElement.removeEventListener("mouseover",this.onMouseOver)}this.actualElement.classList.remove("dragged"),this.actualElement=void 0,document.body.style.cursor="auto",this.actualElementClone.removeEventListener("mouseup",this.onMouseUp),document.documentElement.removeEventListener("mouseover",this.onMouseOver)}}}).bindToDOM(document.querySelector(".container"))})();